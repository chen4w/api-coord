---
title: API
date: 2021-10-22 17:32:15
permalink: /pages/76b411/
---

# HTTP-API

## 一、存证相关数据结构

### Header

#### 1. 路径

> `repchain.inter.cooperation.http.model.Header`

#### 2. 描述

> 存证请求头请求头，包含存证需要调用方和服务方共用的信息。每次请求需要携带当前对象发给服务方。

#### 3.参数

`id`

> 描述：如果持久化到数据库中，用于存储数据库主键
>
> 类型：Long

`cid`

> 描述：请求id，每次请求结束前都需要保持一致，若为异步请求，则异步调用请求方callback接口时，也需要保证cid与请求方存证保持一致。
>
> 类型：String

`e_from`

> 描述：服务调用id，可从RepChain Dashboard-链外协同-服务调用-列表Id列中获取。
>
> 类型：String

`e_to`

> 描述：服务登记id，可从RepChain Dashboard-链外协同-服务登记-列表Id列中获取。
>
> 类型：String

`method`

> 描述：调用服务接口或服务方法，例：'GET http://127.0.0.1:8081/example/getInfos'。
>
> 类型：String

`b_req`

> 描述：请求 or 应答标志, true 代表请求; false 代表应答。
>
> 类型：Boolean

`b_end`

> 描述：结束标志, true 代表结束（即本次请求/应答为最后一个）,False代表未结束。
>
> 类型：Boolean

`seq`

> 描述：请求或应答的序号, 从1开始。
>
> 类型：Integer

`tm_create`

> 描述：请求/应答建立的时间。
>
> 类型：Long

`callback_url`

> 描述：需要应答的地址，在异步调用时，服务端需要根据这个地址进行数据应答。例：'http://192.168.2.2:8889/callback'
>
> 类型：String

`callback_method`

> 描述：需要应答的请求方法类型，如:GET，POST，DELETE等。
>
> 类型：String

`validStr`

> 描述：用于校验权限签名的字符串，此字符串是调用时或应答时进行签名的字符串，可以是请求参数或应答结果，也可以是随机生成字符串。
>
> 类型：String

`signData`

> 描述：对`validStr`进行签名后的HEX数据。
>
> 类型：String

`data`

> 描述：异步请求时，服务提供方需要进行持久化，调用方通过参数传过来的数据，可将接口参数转为json字符串存入此字段。
>
> 类型：String

`state`

> 描述：是否应答状态，0为未应答，1为已应答，如果将Header对象持久化到数据库，则在应答时可更改此状态进行区分是否应答。若需要持久化可忽略此字段。
>
> 类型：Integer

### Signature

#### 1. 路径

> `repchain.inter.cooperation.http.model.tran.Signature`

#### 2. 描述

> 签名对象，用于保存签名内容，签名hash和签名者信息等内容。

#### 3.参数

`eid`

> 描述：RepChain中用户的唯一ID，用户信息中对应字段creditCode
>
> 类型：String

`cert_name`

> 描述：对应`eid`指向用户的证书名称
>
> 类型：String

`hash`

> 描述：需要存证的数据的hash，使用者会对此hash进行数据签名
>
> 类型：String

`timeCreate`

> 描述：签名的时间戳
>
> 类型：Long

`sign`

> 描述：对hash签名后的hex字符串。
>
> 类型：String

### ReqAckProof

#### 1. 路径

> `repchain.inter.cooperation.http.model.tran.ReqAckProof`

#### 2. 描述

> 提交给RepChain用于接口协同存证的数据结构，部分数据结构与Header一致。

#### 3.参数

`cid`

> 描述：请求id，每次请求结束前都需要保持一致，若为异步请求，则异步调用请求方callback接口时，也需要保证cid与请求方存证保持一致。
>
> 类型：String

`e_from`

> 描述：服务调用id，可从RepChain Dashboard-链外协同-服务调用-列表Id列中获取。
>
> 类型：String

`e_to`

> 描述：服务登记id，可从RepChain Dashboard-链外协同-服务登记-列表Id列中获取。
>
> 类型：String

`method`

> 描述：调用服务接口或服务方法，例：'GET http://127.0.0.1:8081/example/getInfos'。
>
> 类型：String

`b_req`

> 描述：请求 or 应答标志, true 代表请求; false 代表应答。
>
> 类型：Boolean

`b_end`

> 描述：结束标志, true 代表结束（即本次请求/应答为最后一个）,False代表未结束。
>
> 类型：Boolean

`seq`

> 描述：请求或应答的序号, 从1开始。
>
> 类型：Integer

`tm_create`

> 描述：请求/应答建立的时间。
>
> 类型：Long

`hash`

> 描述：请求/应答内容 Hash依据 b_req 和 b_end 的值，分别对应请求/应答内容的按照接口定义中指定的 Hash 算法生成的 Hash
>
> 类型：String

`hash_claim`

> 描述：选择性披露 Hash，最后一个应答后，由所有请求和应答的 Hash 按顺序拼接后取 Hash 生成，同步请求可忽略。
>
> 类型：String

`sign_r`

> 描述：接口请求方按照接口定义中指定的签名算法对内容 Hash 的签名。
>
> 类型：[Signature](/pages/76b411/#signature)

`sign_c`

> 描述：对`validStr`进行签名后的HEX数据。
>
> 类型：[Signature](/pages/76b411/#signature)

## 二、YAML文件相关数据结构

### RepChainConfig

#### 1. 路径

> `repchain.inter.cooperation.http.model.yml.RepChainConfig`

#### 2. 描述

> 获取RepChain yml内容最上层的类。

#### 3.参数

`repchain`

> 描述：yml 文件中的repchain内容。
>
> 类型：[Repchain](/pages/76b411/#repchain)

### RepChain

#### 1. 路径

> `repchain.inter.cooperation.http.model.yml.RepChain`

#### 2. 描述

> 用来读取RepChain相关配置信息的类。

#### 3.参数

`host`

> 描述：RepChain的地址，例：'192.168.4.12:8082'。
>
> 类型：String

`interCo`

> 描述：接口协同相关配置，若有多个证书可配置多个项。
>
> 类型：List<[InterCo](/pages/76b411/#interco)>

### InterCo

#### 1. 路径

> `repchain.inter.cooperation.http.model.yml.InterCo`

#### 2. 描述

> 接口协同相关信息类，保存了接口协同相关配置信息，如证书、私钥等内容。

#### 3.参数

`creditCode`

> 描述：用户在RepChain中的唯一标识。
>
> 类型：String

`certName`

> 描述：用户在上面creditCode账号下所挂载的证书别名。
>
> 类型：String

`cert`

> 描述：用户对应的证书内容。
>
> 类型：String

`privateKey`

> 描述：用户的私钥。
>
> 类型：String

`algo_hash`

> 描述：服务定义中，所定义的hash取值的算法。
>
> 类型：String

`algo_sign`

> 描述：服务定义中，所定义的对数据签名时的签名算法。
>
> 类型：String

`password`

> 描述：当前私钥所设置的密码。
>
> 类型：String

`services`

> 描述：当前证书所对应的接口服务，一个证书可对应多个服务。
>
> 类型：List<[Service](/pages/76b411/#service)>

### Service

#### 1. 路径

> `repchain.inter.cooperation.http.model.yml.Service`

#### 2. 描述

> 包含在上一层对象证书下的接口服务内容。

#### 3.参数

`e_from`

> 描述：服务调用id，可从RepChain Dashboard-链外协同-服务调用-列表Id列中获取。
>
> 类型：String

`from_host`

> 描述：服务调用地址，可从RepChain Dashboard-链外协同-服务调用-列表地址列中获取。
>
> 类型：String

`from_port`

> 描述：服务调用端口，可从RepChain Dashboard-链外协同-服务调用-列表端口列中获取。
>
> 类型：String

`from_cert`

> 描述：服务调用方的证书，当前版本需要服务方和调用方线下进行证书交换来获取证书。
>
> 类型：String

`e_to`

> 描述：服务登记id，可从RepChain Dashboard-链外协同-服务登记-列表Id列中获取。
>
> 类型：String

`to_host`

> 描述：服务登记地址，可从RepChain Dashboard-链外协同-服务登记-列表地址列中获取。
>
> 类型：String

`to_port`

> 描述：服务登记端口，可从RepChain Dashboard-链外协同-服务登记-列表端口列中获取。
>
> 类型：String

`to_cert`

> 描述：服务提供方的证书，当前版本需要服务方和调用方线下进行证书交换来获取证书。
>
> 类型：String

## 三、返回结果数据结构

### InterCoResult

#### 1. 路径

> `repchain.inter.cooperation.http.model.InterCoResult`

#### 2. 描述

> 用于接口调用之间返回结果，可根据业务需求自行更改。

#### 3.参数

`code`

> 描述：状态码，0为无异常，其他状态码请根据业务自行设计。
>
> 类型：Integer

`msg`

> 描述：返回结果提示的消息，常用于提示错误消息。
>
> 类型：String

`signature`

> 描述：签名信息，用于存储传输返回结果中的签名对象信息。
>
> 类型：[Signature](/pages/76b411/#signature)

`data`

> 描述：返回相应的业务数据。
>
> 类型：Object

